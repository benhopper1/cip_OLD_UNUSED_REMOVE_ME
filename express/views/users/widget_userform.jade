doctype html
html
	head(lang="en")
		title Account
		meta(http-equiv="content-type", content="text/html; charset=UTF-8")
		meta(name="description", content="")
		meta(name="keywords", content="")
		meta(name="viewport", content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0")
		// if lt IE 9

		link(rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css")
		script(src="http://code.jquery.com/jquery-1.11.1.min.js")
		script(src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js")

		//script(type='text/javascript', src='/js/jquery/jquery-2.0.3.min.js')
		script(type='text/javascript', src='/js/clientutil/clientutil.js')


		script(type='text/javascript', src='/public/js/easyui/jquery.easyui.min.js')
		link(rel='stylesheet', href='/public/js/easyui/themes/default/easyui.css')
		link(rel='stylesheet', href='/public/js/easyui/themes/default/icon.css')

		//background-color: #000000
		body(style="")

			style.
				.imgAndData{
					font-size: 13px;
					font-style: normal;
					font-weight: normal;
					padding-left: 5px;
					LINE-HEIGHT:15px;
					background-color: #eee;

				}

				.magicCirc{
					padding:4px;
					display:inline-block;
					font:12px/14px Arial, Helvetica, sans-serif;
					color:#666;
					border:1px solid #999;
					background-color:#eee;
					-moz-border-radius:10px;
					-webkit-border-radius: 150px;
					-moz-box-shadow:#999 2px 0px 3px;
					-webkit-box-shadow:#999 2px 0px 3px;
					margin-bottom:4px;
				}

				.magicCircPnt{
					padding:4px;
					display:inline-block;
					cursor:pointer;
					font:12px/14px Arial, Helvetica, sans-serif;
					color:#666;
					border:1px solid #999;
					background-color:#eee;
					-moz-border-radius:10px;
					-webkit-border-radius: 150px;
					-moz-box-shadow:#999 2px 0px 3px;
					-webkit-box-shadow:#999 2px 0px 3px;
					margin-bottom:4px;
				}

				.center{
					margin-left: auto;
					margin-right: auto;
					width: 70%;
					background-color: #b0e0e6;
				}

				.magicSquarePnt{
					cursor:pointer;
					padding:4px;
					display:inline-block;
					font:12px/14px Arial, Helvetica, sans-serif;
					color:#666;
					border:1px solid #999;
					background-color:#eee;
					-moz-border-radius:00px;
					-webkit-border-radius: 15px;
					-moz-box-shadow:#999 2px 0px 3px;
					-webkit-box-shadow:#999 2px 0px 3px;
					margin-bottom:4px;
				}


				//- @-webkit-keyframes thumb {
				//- 	0% { -webkit-transform: scale(1); }
				//- 	50% { -webkit-transform: scale(0.5); }
				//- 	100% { -webkit-transform: scale(1); }
				//- }

				//- .backbutton img:hover{
				//- 	-webkit-animation-name: thumb;
				//- 	-webkit-animation-duration: 200ms;
				//- 	-webkit-transform-origin:50% 50%;
				//- 	-webkit-animation-iteration-count: 2;
				//- 	-webkit-animation-timing-function: linear;
				//- }

				@-webkit-keyframes spaceboots {
					0% { -webkit-transform: translate(2px, 1px) rotate(0deg); }
					10% { -webkit-transform: translate(-1px, -2px) rotate(-40deg); }
					20% { -webkit-transform: translate(-3px, 0px) rotate(40deg); }
					30% { -webkit-transform: translate(0px, 2px) rotate(0deg); }
					40% { -webkit-transform: translate(1px, -1px) rotate(1deg); }
					50% { -webkit-transform: translate(-1px, 2px) rotate(-1deg); }
					60% { -webkit-transform: translate(-3px, 1px) rotate(0deg); }
					70% { -webkit-transform: translate(2px, 1px) rotate(-1deg); }
					80% { -webkit-transform: translate(-1px, -1px) rotate(1deg); }
					90% { -webkit-transform: translate(2px, 2px) rotate(0deg); }
					100% { -webkit-transform: translate(1px, -2px) rotate(-1deg); }
				}
				.shake {
					-webkit-animation-name: spaceboots;
					-webkit-animation-duration: 0.8s;
					-webkit-transform-origin:50% 50%;
					-webkit-animation-iteration-count: 15;//infinite;
					-webkit-animation-timing-function: linear;
				}

				img{
					max-width: 100%;
				}

				.ui-page {
					background: transparent;
				}
				.ui-content{
					background: transparent;
				}
				body {
					background: url(/public/images/ui/accountbkg.png);
					background-repeat:repeat-y;
					background-position:center center;
					background-attachment:scroll;
					background-size:100% 100%;
				}


			form(action="/upload", method="post", enctype="multipart/form-data")
				input(id="upload" type="file" name="uploadedFile" style="display: none;" onchange="console.log('changed!!!')")

			//background-color:black
			div(id="page_userForm" data-role="page" data-theme="b" style="")
				//div(data-role="header")
					//a(href="index.html" data-icon="delete") Cancel
					//h1 Create User Account
				center
					img(src="/public/images/ui/arfsync_logo.png")
					//a(href="index.html" data-icon="check") Save

				div(id="contactsWindow" data-role="main" class="ui-content")
					form(method="post" id="userForm")
						div(class="ui-field-contain")
							//label(for="fname" class="ui-hidden-accessible") Firstname
							input(tabindex="1" type="text" id="widget_userForm_firstName" 	name="fname" 		placeholder="First Name...")
							input(tabindex="2" type="text" id="widget_userForm_lastName" 	name="lName" 		placeholder="Last Name...")
							input(tabindex="3" type="text" id="widget_userForm_phone" 		name="phoneNumber" 	placeholder="Phone Number...")
							input(tabindex="4" type="email" id="widget_userForm_email" 		name="email" 		placeholder="Email Address...")
							input(tabindex="5" type="text" id="widget_userForm_userName" 	name="userName" 	placeholder="User Name...")
							input(tabindex="6" type="password" id="widget_userForm_password" 	name="password" 	placeholder="Password...")
							input(tabindex="7" type="password" id="widget_userForm_password2" 	name="password2" 	placeholder="Password Again (sorry!!)...")
							input(tabindex="8" type="text" id="widget_userForm_address" 		name="address" 		placeholder="Address...")
							input(tabindex="9" type="text" id="widget_userForm_city" 		name="city" 		placeholder="City...")
							input(tabindex="10" type="text" id="widget_userForm_state" 		name="state" 		placeholder="State...")
							input(tabindex="11" type="text" id="widget_userForm_zipcode" 		name="zip" 			placeholder="Zip Code...")
							input(tabindex="12" type="text" id="widget_userForm_country" 		name="country" 		placeholder="Country...")
							center
								h6 (click to change)
								img(id="widget_userForm_image" name="uImg" class="magicSquarePnt contactAddImage" src="/public/images/contacts/default.jpg" style="height:100px;" onclick="Widget_userFormScript.chooseFile();")
								h5 This is you 
							input(data-icon="action" id="addEditUser_save" 	type="button" value="Save")
							input(data-icon="back" id="addEditUser_clear" 	type="button" value="Cancel")



			script.
				var Widget_userFormScript;
				$(document).ready(function(){

					Widget_userFormScript = new function(){
						var _this = this;

						$('#upload').change(function(){
							//new image to dispay.
							_this.uploadImage();
						});
						this.load = function(){
							$('#userForm_window').window({
								title:'User Form',
								closed:true,
								width:'100%',
								height:'100%',
								modal:true,
								minimizable:false,
								maximizable:false,
								onBeforeClose: function(){
								},
								onBeforeOpen: function(){
								},
							});

							//- $('#addEditUser_save').linkbutton(
							//- 	{
							//- 		text:'Save',
							//- 		//iconCls:'icon-send',
							//- 		//iconAlign:'left',
							//- 		width:80
							//- 	}
							//- );

							//- $('#addEditUser_clear').linkbutton(
							//- 	{
							//- 		text:'Clear',
							//- 		//iconCls:'icon-send',
							//- 		//iconAlign:'left',
							//- 		width:80
							//- 	}
							//- );

							//==============================================
							// EVENT SETUP
							//==============================================
							$('#addEditUser_save').click(function(){
								_this.addToStore();
							});
							$('#addEditUser_clear').click(function(){
								//- $.get( "/users/checkemail", function(data){
								//- 	$("#contactsWindow").html(data);
								//- });
								_this.cancel();
							});
							
						}

						this.updateImageSource = function(inSrc){
							//console.log('updateImageSource ENTERED(html):' + inSrc);
							$('#widget_userForm_image').attr('src', inSrc);
							//$('#widget_userForm_country').val(inSrc);
							//console.log($('#widget_userForm_image').attr('src'));
							//console.log($('#widget_userForm_country').val());
						}

						this.cancel = function(){
							window.location = "/user/mobilelogin";
						}

						this.close = function(){
							$('#userForm_window').window('close');
						}

						this.show = function(){
							$('#userForm_window').window('open');
						}

						this.chooseFile = function(){
							$('#upload').trigger('click');
						}

						this.uploadImage = function(){
							$ajaxFilePost(
								{
									fileInputElement:'upload',

									options:
										{
											command:'imageStore',
											theme:'normalUserImage'
										},

									onComplete:function(inResponse){
										if(inResponse.domainFilePath){
											$('#widget_userForm_image').attr('src', inResponse.domainFilePath);
										}
									}
								}
							);
						}

						this.addToStore = function(){
							$postAjax(
								{
									url:'database/addUser',
									send:
										{
											firstName:		$('#widget_userForm_firstName').val(),
											lastName:		$('#widget_userForm_lastName').val(),
											emailAddress:	$('#widget_userForm_email').val(),
											userName:		$('#widget_userForm_userName').val(),
											password:		$('#widget_userForm_password').val(),
											address:		$('#widget_userForm_address').val(),
											city:			$('#widget_userForm_city').val(),
											state:			$('#widget_userForm_state').val(),
											zipcode:		$('#widget_userForm_zipcode').val(),
											country:		$('#widget_userForm_country').val(),
											screenImage:	$('#widget_userForm_image').attr('src'),
											//activateCode:	$('#widget_userForm_firstName').val(),
										},
									onAjaxSuccess:function(inHtml){
										inResponseText = JSON.parse(inHtml);
										console.log('back from db------------');
										//- $.get( "/users/checkemail", function(data){
										//- 	$("#contactsWindow").append(data);
										//- });
										//$.mobile.loadPage("/users/checkemail");
										//console.dir(inResponseText);
										//$('body').html(inHtml);//{renders:users/checkemail.jade}
										$('#contactsWindow').load("/users/checkemail #form_checkMail");
									}
								}
							);

						}






						_this.load();
						_this.show();
					}();

					

					//- $('#main').css({
					//- 	'height': ($(document).height()) + 'px'
					//- });

					//- $(window).resize(function () {
					//- 	$('#main').css({
					//- 		'height': ($(document).height()) + 'px'
					//- 	});
					//- });
					//if((Browser.Platform.ios) || (Browser.Platform.webos) || (Browser.Platform.android)) {
						//For iPhone and Andriod To remove Address bar when viewing website on Safari Mobile
						// When ready...
						//window.addEventListener("load",function() {
						// Set a timeout...
						
						//});
					//}

				});